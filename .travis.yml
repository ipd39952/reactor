language: ruby
os: linux
dist: xenial
cache:
  directories:
    - reactor_test/vendor/bundle
rvm:
  - 2.4.10
  - 2.7.4
env:
  jobs:
    - BUNDLE_GEMFILE=Gemfile
    - BUNDLE_GEMFILE=Gemfile.rails51
    - BUNDLE_GEMFILE=Gemfile.rails50
services:
  - docker
if: branch =~ /^travis|^develop$|^master$/
before_install:
  - export TZ=Europe/Berlin
  - cd reactor_test
  - gem install bundler
  - travis/docker_login.sh
before_script:
  - travis/docker_start.sh
  - travis/docker_ready.sh
  - cp config/initializers/reactor.rb.example config/initializers/reactor.rb
after_script:
  - cd docker-build
  - docker-compose down --volumes
jobs:
  include:
  - name: Rubocop
    cache:
      directories:
        - infopark_reactor/vendor/bundle
    before_install:
      - cd infopark_reactor
    before_script: skip
    script: bundle exec rubocop
    after_script: skip
